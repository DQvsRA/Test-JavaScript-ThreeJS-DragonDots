THREE.WebGLRenderer3=function(e){console.log("THREE.WebGLRenderer3",THREE.REVISION),e=e||{};var r,t=this,i=void 0!==e.canvas?e.canvas:document.createElement("canvas"),o=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;try{var n=e.contextAttributes||{};if(r=i.getContext("webgl",n)||i.getContext("experimental-webgl",n),null===r)throw"Error creating WebGL context."}catch(a){console.error(a)}var l="highp",s={};null!==r&&(s.element_index_uint=r.getExtension("OES_element_index_uint"),s.texture_float=r.getExtension("OES_texture_float"),s.texture_float_linear=r.getExtension("OES_texture_float_linear"),s.standard_derivatives=r.getExtension("OES_standard_derivatives"),s.texture_filter_anisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),s.compressed_texture_s3tc=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),r.clearColor(0,0,0,1),r.clearDepth(1),r.clearStencil(0),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.enable(r.CULL_FACE),r.frontFace(r.CCW),r.cullFace(r.BACK),r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.clearColor(0,0,0,0));var c=new THREE.Color(0),m=0,f=new THREE.Vector3,d=new THREE.Frustum,E=new THREE.Matrix3,u=new THREE.Matrix4,x=new THREE.Matrix4,v={},g=function(e,i){var o=e.id.toString()+"+"+i.id.toString();if(void 0!==v[o])return v[o];for(var n=e.vertices,a=e.faces,l=[],s=function(e){l.push(e.x,e.y,e.z)},c=[],m=function(e){c.push(e.x,e.y,e.z)},f=0,d=a.length;d>f;f++){var E=a[f],u=E.vertexNormals.length>0;s(n[E.a]),s(n[E.b]),s(n[E.c]),u===!0?(m(E.vertexNormals[0]),m(E.vertexNormals[1]),m(E.vertexNormals[2])):(m(E.normal),m(E.normal),m(E.normal))}var x={positions:r.createBuffer(),normals:r.createBuffer(),count:l.length/3};return r.bindBuffer(r.ARRAY_BUFFER,x.positions),r.bufferData(r.ARRAY_BUFFER,new Float32Array(l),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,x.normals),r.bufferData(r.ARRAY_BUFFER,new Float32Array(c),r.STATIC_DRAW),v[o]=x,t.info.memory.geometries++,x},_={},h={},p=function(e){if(void 0!==_[e.id])return _[e.id];var i=["precision "+l+" float;","precision "+l+" int;","attribute vec3 position;","attribute vec3 normal;","uniform mat4 modelViewMatrix;","uniform mat3 normalMatrix;","uniform mat4 projectionMatrix;",""].join("\n"),o=["precision "+l+" float;","precision "+l+" int;",""].join("\n");e instanceof THREE.ShaderMaterial?(i+=e.vertexShader,o+=e.fragmentShader):e instanceof THREE.MeshNormalMaterial?(i+=["varying vec3 vNormal;","void main() {","	vNormal = normalize( normalMatrix * normal );","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),o+=["varying vec3 vNormal;","uniform float opacity;","void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")):(i+=["void main() {","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),o+=["void main() {","	gl_FragColor = vec4( 1.0, 0, 0, 1.0 );","}"].join("\n"));var n,a=i+o;return void 0!==h[a]?(n=h[a],_[e.id]=n):(n=r.createProgram(),r.attachShader(n,R(r.VERTEX_SHADER,i)),r.attachShader(n,R(r.FRAGMENT_SHADER,o)),r.linkProgram(n),r.getProgramParameter(n,r.LINK_STATUS)===!0?(h[a]=n,_[e.id]=n,t.info.memory.programs++):(console.error("Program Info Log: "+r.getProgramInfoLog(n)),console.error("VALIDATE_STATUS: "+r.getProgramParameter(n,r.VALIDATE_STATUS)),console.error("GL_ERROR: "+r.getError()),n=p(new THREE.MeshBasicMaterial),_[e.id]=n)),n},R=function(e,t){var i=r.createShader(e);return r.shaderSource(i,t),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)!==!0?(console.error(r.getShaderInfoLog(i),t),null):i};this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this.domElement=i,this.extensions=s,this.autoClear=!0,this.setClearColor=function(e,t){c.set(e),m=void 0!==t?t:1,r.clearColor(c.r,c.g,c.b,m)},this.setSize=function(e,t,n){i.width=e*o,i.height=t*o,1!==o&&n!==!1&&(i.style.width=e+"px",i.style.height=t+"px"),r.viewport(0,0,i.width,i.height)},this.clear=function(e,t,i){var o=0;(void 0===e||e)&&(o|=r.COLOR_BUFFER_BIT),(void 0===t||t)&&(o|=r.DEPTH_BUFFER_BIT),(void 0===i||i)&&(o|=r.STENCIL_BUFFER_BIT),r.clear(o)};var A,T,M,S=null,L=function(e){e!==S&&(e===THREE.NoBlending?r.disable(r.BLEND):r.enable(r.BLEND),S=e)},b=[],F=[],B=function(e,r){if(e.visible!==!1){e instanceof THREE.Mesh&&d.intersectsObject(e)===!0&&(null!==e.renderDepth?e.z=e.renderDepth:(f.getPositionFromMatrix(e.matrixWorld),f.applyProjection(x),e.z=f.z),e.material.transparent===!0?F.push(e):b.push(e));for(var t=0,i=e.children.length;i>t;t++)B(e.children[t],r)}},y=function(e,r){return e.z-r.z},C=function(e,r){return e.z!==r.z?r.z-e.z:r.id-e.id},N={},P=function(e,i){var o=g(e.geometry,e.material),n=e.material;if(n!==T){var a=p(e.material);if(a!==M&&(r.useProgram(a),N.modelViewMatrix=r.getUniformLocation(a,"modelViewMatrix"),N.normalMatrix=r.getUniformLocation(a,"normalMatrix"),N.projectionMatrix=r.getUniformLocation(a,"projectionMatrix"),N.position=r.getAttribLocation(a,"position"),N.normal=r.getAttribLocation(a,"normal"),r.uniformMatrix4fv(N.projectionMatrix,!1,i.projectionMatrix.elements),M=a),n instanceof THREE.MeshNormalMaterial)r.uniform1f(r.getUniformLocation(a,"opacity"),n.opacity);else if(n instanceof THREE.ShaderMaterial){var l=n.uniforms;for(var s in l){var c=r.getUniformLocation(a,s),m=l[s].type,f=l[s].value;"i"===m?r.uniform1i(c,f):"f"===m?r.uniform1f(c,f):"v2"===m?r.uniform2f(c,f.x,f.y):"v3"===m?r.uniform3f(c,f.x,f.y,f.z):"v4"===m?r.uniform4f(c,f.x,f.y,f.z,f.w):"c"===m&&r.uniform3f(c,f.r,f.g,f.b)}}T=n}o!==A&&(r.bindBuffer(r.ARRAY_BUFFER,o.positions),r.enableVertexAttribArray(N.position),r.vertexAttribPointer(N.position,3,r.FLOAT,!1,0,0),N.normal>=0&&(r.bindBuffer(r.ARRAY_BUFFER,o.normals),r.enableVertexAttribArray(N.normal),r.vertexAttribPointer(N.normal,3,r.FLOAT,!1,0,0)),A=o),u.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),E.getNormalMatrix(u),r.uniformMatrix4fv(N.modelViewMatrix,!1,u.elements),r.uniformMatrix3fv(N.normalMatrix,!1,E.elements),r.drawArrays(r.TRIANGLES,0,o.count),t.info.render.calls++};this.render=function(e,r){if(this.autoClear===!0&&this.clear(),e.updateMatrixWorld(),void 0===r.parent&&r.updateMatrixWorld(),r.matrixWorldInverse.getInverse(r.matrixWorld),x.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),d.setFromMatrix(x),b.length=0,F.length=0,t.info.render.calls=0,A=void 0,T=void 0,M=void 0,B(e,r),b.length>0){b.sort(y),L(THREE.NoBlending);for(var i=0,o=b.length;o>i;i++)P(b[i],r)}if(F.length>0){F.sort(C),L(THREE.NormalBlending);for(var i=0,o=F.length;o>i;i++)P(F[i],r)}}};